<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="icon" type="image/png" href="./img/CILKGax.png">
    <!-- Tiêu đề của trang dòng thời gian -->
    <title>Thời gian đã trải qua</title>
    <link type="text/css" rel="stylesheet" href="./css/default.css">
    <link rel="stylesheet" href="./css/style.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <script type="text/javascript" src="./js/jquery.min.js"></script>
    <script type="text/javascript" src="./js/functions.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/love.js" charset="utf-8"></script>
    <style type="text/css"></style>
    <style>
        #code {
			color: #163e98;
			font-size: 17px;
			font-weight: 500;
			text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
			font-family: 'Montserrat', sans-serif;
			line-height: 1.5;
			text-align: justify;
        }
        .say {
            display: block;
			margin-bottom: 20px;
        }
        .space {
            margin-left: -15px;
        }
        .STYLE1 {
            font-weight: bold;
            color: #000;
        }
        #clock-box {
            text-align: center;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="buttons">
        <!-- <a href="index.html" class="btn btn-bir">Sinh nhật</a> -->
        <!-- <a href="timeline.html" class="btn btn-timeline">Dòng thời gian</a>
            <a href="gallery/index.html" class="btn btn-gallery">Ảnh kĩ niệm</a> -->
    </div>
    <div id="main">
        <div id="wrap">
            <div id="text">
                <div id="code" style="display: none;">
                    <span class="say">Gửi đến thầy cô – những người lái đò thầm lặng đã đưa em qua dòng sông tri thức!</span>
                    <span class="say">Vậy là kỳ thi THPT Quốc gia đã chính thức khép lại – đánh dấu một chặng đường đầy nỗ lực và cảm xúc. Em muốn viết vài dòng để gửi đến thầy cô, những người đã luôn âm thầm đồng hành và tiếp sức cho em suốt ba năm qua.</span>
					<span class="say">Ba năm cấp ba là một hành trình không dễ dàng, nhưng chắc chắn là một trong những quãng thời gian đáng nhớ nhất đời em. Trong hành trình ấy, thầy cô không chỉ truyền đạt cho em kiến thức, mà còn là người thắp lên trong em động lực, niềm tin và cả ước mơ.</span>
                    <span class="say">Em biết ơn vì trên chuyến hành trình này luôn có hình bóng thầy cô dõi theo.</span>
                    <span class="say">Một lần nữa, em xin gửi lời cảm ơn chân thành nhất. Em kính chúc thầy cô luôn mạnh khỏe, hạnh phúc và tiếp tục là người dẫn dắt cho những thế hệ học trò tiếp theo.</span>
                    <span style="align-items: center; margin-left: 20px;" class="say"><span class="space"></span>-- Thương mến, học trò của thầy cô ♥️ --</span>
                </div>
            </div>
            <canvas id="canvas" width="1100" height="680"></canvas>
        </div>

    </div>

    <!-- Phần nhạc -->
    <audio id="player" autoplay loop>
        <source src="./music/piano.mp3" type="audio/mp3" />
    </audio>
    <script>
		const player = document.getElementById("player");

		$(document).one('click', function () {
			player.muted = false;
			player.play();
		});
        $(document).ready(() => {
            const canvas = $('#canvas')[0];
            if (!canvas.getContext) {
                $("#error").show();
                return;
            }

            const width = 1100;
            const height = 680;
            canvas.width = width;
            canvas.height = height;

            const opts = {
                seed: {
                    x: width / 2 - 20,
                    color: "rgb(190, 26, 37)",
                    scale: 2
                },
                branch: [
                    [535, 680, 570, 250, 500, 200, 30, 100, [
                        [540, 500, 455, 417, 340, 400, 13, 100, [
                            [450, 435, 434, 430, 394, 395, 2, 40]
                        ]],
                        [550, 445, 600, 356, 680, 345, 12, 100, [
                            [578, 400, 648, 409, 661, 426, 3, 80]
                        ]],
                        [539, 281, 537, 248, 534, 217, 3, 40],
                        [546, 397, 413, 247, 328, 244, 9, 80, [
                            [427, 286, 383, 253, 371, 205, 2, 40],
                            [498, 345, 435, 315, 395, 330, 4, 60]
                        ]],
                        [546, 357, 608, 252, 678, 221, 6, 100, [
                            [590, 293, 646, 277, 648, 271, 2, 80]
                        ]]
                    ]]
                ],
                bloom: {
                    num: 700,
                    width: 1080,
                    height: 650,
                },
                footer: {
                    width: 1200,
                    height: 5,
                    speed: 10,
                }
            };

            const tree = new Tree(canvas, width, height, opts);
            const seed = tree.seed;
            const foot = tree.footer;
            let hold = 1;

            canvas.addEventListener('click', (e) => {
                const offset = canvas.getBoundingClientRect();
                const x = e.pageX - offset.left;
                const y = e.pageY - offset.top;
                if (seed.hover(x, y)) {
                    hold = 0;
                    canvas.style.cursor = 'default';
                }
            });

            canvas.addEventListener('mousemove', (e) => {
                const offset = canvas.getBoundingClientRect();
                const x = e.pageX - offset.left;
                const y = e.pageY - offset.top;
                canvas.style.cursor = seed.hover(x, y) ? 'pointer' : 'default';
            });

            const sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));

            async function seedAnimate() {
                seed.draw();
                while (hold) {
                    await sleep(10);
                }
                while (seed.canScale()) {
                    seed.scale(0.95);
                    await sleep(10);
                }
                while (seed.canMove()) {
                    seed.move(0, 2);
                    foot.draw();
                    await sleep(10);
                }
            }

            async function growAnimate() {
                while (tree.canGrow()) {
                    tree.grow();
                    await sleep(10);
                }
            }

            async function flowAnimate() {
                do {
                    tree.flower(2);
                    await sleep(10)
                } while (tree.canFlower());
            }

            async function moveAnimate() {
                tree.snapshot("p1", 240, 0, 610, 680);
                while (tree.move("p1", 500, 0)) {
                    foot.draw();
                    await sleep(10);
                }
                foot.draw();
                tree.snapshot("p2", 500, 0, 610, 680);

                canvas.parentElement.style.background = `url(${tree.toDataURL('image/png')})`;
                await sleep(300);
                canvas.style.background = "none";
            }

            async function jumpAnimate() {
                const ctx = tree.ctx;
                while (true) {
                    ctx.clearRect(0, 0, width, height);
                    tree.jump();
                    foot.draw();
                    await sleep(25);
                }
            }

            async function textAnimate() {
                $("#code").show().typewriter();
            }

            async function runAsync() {
                await seedAnimate();
                await growAnimate();
                await flowAnimate();
                await moveAnimate();
                textAnimate();
                jumpAnimate();
            }

            runAsync();
        });
    </script>
    </div>
</body>

</html>